<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">/*
 * @author &lt;a href='bocelli.hu@gmail.com'&gt;bocelli.hu&lt;/a&gt;
 * @version 1.0
 * */
Package('tupai.util')
.define('CommonUtil', function(cp) {
    var elm = document.createElement('div');
    var getDataSet, getDataSets;
    if (!elm.dataset) {
        /*
        var camelize = function(str) {
            return str.replace(/-+(.)?/g, function(match, chr) {
                return chr ? chr.toUpperCase() : '';
            });
        };
        */
        var toDash = function(str) {
            return str.replace(/([A-Z])/g, function(m) { return '-'+m.toLowerCase(); });
        };
        var toCamel = function(str) {
            var tokens = str.split('-');
            for(var i=1, n=tokens.length; i&lt;n; i++) {
                var s = tokens[i];
                if(!s[0]) continue;
                tokens[i] = s[0].toUpperCase()+s.substring(1);
            }
            return tokens.join('');
        };
        getDataSet = function(element, name) {
            var dataName = 'data-';
            var attrs = element.attributes;
            var attrName  = dataName + toDash(name);

            var attr = attrs[attrName];
            return attr &amp;&amp; attr.value;
        };
        getDataSets = function(element, matchName) {
            var attrs = element.attributes;
            var datasets = {};
            var regexp;
            if(matchName) {
                regexp = new RegExp(matchName);
            }
            for(var i=0, n=attrs.length; i&lt;n; i++) {
                var attr = attrs[i];
                var name = attr.name;
                if(/^data-/.test(name)) {
                    var attrName  = toCamel(name.substring(5));
                    if(regexp &amp;&amp; !regexp.test(attrName)) continue;
                    datasets[attrName] = attr.value;
                }
            }
            return datasets;
        };
    } else {
        getDataSet = function(element, name) {
            return element.dataset[name];
        };
        getDataSets = function(element, matchName) {

            if(!matchName) {
                return element.dataset;
            }
            var ret = {};
            var datasets = element.dataset;
            var regexp = new RegExp(matchName);
            for(var name in datasets) {
                if(!regexp.test(name)) continue;
                ret[name] = datasets[name];
            }
            return ret;
        };
    }

    var haveClassList = !!elm.classList;

    var bind = function() {
        var args = Array.prototype.slice.call(arguments);
        var func = args.shift(), object = args.shift();
        return function() {
            return func.apply(object, args.concat(Array.prototype.slice.call(arguments)));
        };
    };
    var isValidUrl = function(url) {
        if(!url) return false;
        return !!url.match(/^(https?|ftp)(:\/\/[-_.!~*\'()a-zA-Z0-9;\/?:\@&amp;=+\$,%#]+)$/);
    };
    var isValidHttpUrl = function(url) {
        if(!url) return false;
        return !!url.match(/^(https?)(:\/\/[-_.!~*\'()a-zA-Z0-9;\/?:\@&amp;=+\$,%#]+)$/);
    };

    var trim;
    if(String.prototype.trim) {
        trim = function(s) {
            return s.trim();
        };
    } else {
        trim = function(s) {
            return s.replace(/(^\s+)|(\s+$)/g, &quot;&quot;);
        };
    }

    return {
        bind: bind,
        isValidUrl: isValidUrl,
        isValidHttpUrl: isValidHttpUrl,
        haveClassList: haveClassList,
        trim: trim,
        getDataSets: getDataSets,
        getDataSet: getDataSet
    };
});
</pre>
</body>
</html>
